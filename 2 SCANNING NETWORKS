
 wake up, Neo...                                                                                         
        the matrix has you                                                                                         
      follow the white rabbit.

          knock, knock, Neo.

                        (`.         ,-,
                        ` `.    ,;' /
                         `.  ,'/ .'
                          `. X /.'
                .-;--''--.._` ` (
              .'            /   `
             ,           ` '   Q '
             ,         ,   `._    \
          ,.|         '     `-.;_'
          :  . `  ;    `  ` --,.._;
           ' `    ,   )   .'
              `._ ,  '   /_
                 ; ,''-,;' ``-
                  ``-..__``--`

                             https://metasploit.com



 ____   ____    _    _   _ _   _ ___ _   _  ____ 
/ ___| / ___|  / \  | \ | | \ | |_ _| \ | |/ ___|
\___ \| |     / _ \ |  \| |  \| || ||  \| | |  _ 
 ___) | |___ / ___ \| |\  | |\  || || |\  | |_| |
|____/ \____/_/   \_\_| \_|_| \_|___|_| \_|\____|
                                                 
 _   _ _____ _______        _____  ____  _  ______  
| \ | | ____|_   _\ \      / / _ \|  _ \| |/ / ___| 
|  \| |  _|   | |  \ \ /\ / / | | | |_) | ' /\___ \ 
| |\  | |___  | |   \ V  V /| |_| |  _ <| . \ ___) |
|_| \_|_____| |_|    \_/\_/  \___/|_| \_\_|\_\____/ 



            .       .
            \`-"'"-'/
             } 6 6 {
            ==. Y ,==
              /^^^\  .
             /     \  )  Ncat: A modern interpretation of classic Netcat
            (  )-(  )/
            -""---""---   /
           /   Ncat    \_/
          (     ____
           \_.=|____E
Configuration complete.

          :================:
         /||# nmap -A _   ||
        / ||              ||
       |  ||              ||
        \ ||              ||
          ==================
   ........... /      \.............
   :\        ############            \
   : ---------------------------------
   : |  *   |__________|| ::::::::::  |
   \ |      |          ||   .......   |
     --------------------------------- 8

                                                    
Um ladrão que quer arrombar uma casa procura pontos de acesso como portas e janelas.
Estes são normalmente os pontos de vulnerabilidade da casa, pois são de fácil acesso. Quando
se trata de sistemas e redes de computadores, as portas são as portas e janelas de um
sistema que um intruso utiliza para obter acesso. Uma regra geral para sistemas de
computador é que quanto maior o número de portas abertas num sistema, mais vulnerável é
o sistema. Porém, há casos em que um sistema com menos portas abertas que outra máquina
apresenta um nível de vulnerabilidade muito maior.

+\------------------TRACKING THE ROUTE------------------/+

--> Identificar a rota que os pacotes fazem aé chegar no alvo.
--> Identificar possíveis filtros e bloqueios.
--> Identificar quais pacotes são aceitos.

--> O hoste aceita UDP?
--> O host aceita ICMP?
--> O hoste aceita TCP?
--> O hoste aceita permite determinadas portas?

--> https://www.fasim.com.br/o-que-e-e-como-alterar-o-ttl-em-sistemas-operacionais-windows-e-linux/

┌─[✗]─[root@parrot]─[~]
└──╼ $ ping google.com -c 1 -t 1

┌─[✗]─[root@parrot]─[~]
└──╼ $traceroute google.com.br

┌─[✗]─[root@parrot]─[~]
└──╼ $traceroute google.com.br -w 1 --> Indica que quero um segundo de resposta.

┌─[✗]─[root@parrot]─[~]
└──╼ $traceroute agetelecom.com.br -w 5 --> Quanto maior o tempo de resposta melhor para não
confundir com os pacotes decrementados.

┌─[✗]─[root@parrot]─[~]
└──╼ $traceroute google.com.br -m 20 -f 15 --> -m Quantidades de saltos que quero, -f começar a partir de certo hops.

┌─[✗]─[root@parrot]─[~]
└──╼ $traceroute google.com.br -A --> Mostra os AS  [autonomous system] 

┌─[✗]─[root@parrot]─[~]
└──╼ $traceroute google.com.br -I --> Utiliza o protocolo ICMP para enviar as solicitações.

┌─[✗]─[root@parrot]─[~]
└──╼ $traceroute google.com.br -T --> Utiliza o protocolo TCP para enviar as solicitações.

┌─[root@parrot]─[~]
└──╼ #traceroute google.com.br -n -T -p 80 --> -p Indica a porta de destino.

┌─[root@parrot]─[/home/xploit]
└──╼ #traceroute google.com.br -n -U --> -U Força a Solicitação na porta 53.








+----------------------------------------------------------------------------------------------------------------+
Nota: -sn é o comando Nmap para desabilitar a varredura de porta. Como o Nmap usa a varredura de ping ARP
como varredura de ping padrão, para desativá-lo e realizar outras varreduras de ping desejadas, você pode usar -
desativar-arp-ping

+----------------------------------------------------------------------------------------+
                                                                                         |
--> ARP Ping Scan:                                                                       |
--> nmap -sn -PR 192.168.0.1                                                             |   
                                                                                         |   
+----------------------------------------------------------------------------------------+
                                                                                         |
--> UDP Ping Scan:                                                                       |
--> nmap -sn PU 192.168.1.2                                                              |   
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |   
 --> ICMP ECHO Ping Scan:                                                                |
 --> nmap -sn -PE 192.168.1.3                                                            |   
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |
--> ICMP ECHO Ping Sweep:                                                                |   
--> nmap -sn -PE 192.168.1.4/24                                                          |   
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |
--> ICMP Timestamp Ping Scan:                                                            |       
--> nmap -sn -PP 192.168.1.5                                                             |
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |
--> ICMP Address Mask Ping Scan:                                                         |   
--> nmap -sn -PM 192.168.1.6                                                             |
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |   
--> TCP SYN Ping Scan:                                                                   |
--> nmap -sn -PS80,21,8080,443 192.168.1.7                                               |   
                                                                                         |
+----------------------------------------------------------------------------------------+ 
                                                                                         |
--> TCP ACK Ping Scan:                                                                   |   
--> nmap -sn -PA 192.168.1.8                                                             |
                                                                                         |
+----------------------------------------------------------------------------------------+ 
                                                                                         |
--> IP Protocol Ping Scan:                                                               |
--> nmap -sn -PO 192.168.1.9                                                             |   
                                                                                         |
+----------------------------------------------------------------------------------------+  
                                                                                         |   
--> Angry IP Scanner                                                                     |
--> Source: https://www.angryip.org                                                      |       
                                                                                         |
O scanner IP irritado é um scanner de endereço IP e porta. Ele pode verificar endereços  |   
IP em qualquer intervalo, bem como em qualquer uma de suas portas. Ele faz ping em       |
cada endereço IP para verificar se ele está ativo; em seguida, ele opcionalmente resolve |
seu nome de host, determina o endereço MAC, verifica as portas e assim por diante.       |
                                                                                         |   
+----------------------------------------------------------------------------------------+
                                                                                         |   
Algumas ferramentas adicionais de varredura de ping que um invasor usa para determinar   |
hosts ativos na rede de destino estão listadas abaixo:                                   |
                                                                                         |   
• SolarWinds Engineer's Toolset (https://www.solarwinds.com}                             |
• NetScanTools Pro (https:j/www.netscantools.com}                                        |   
• Colasoft Ping Toai (https://www.colasoft.com}                                          |
■ Visual Ping Tester (http://www.pingtester.net}                                         |           
■ OpUtils (https:j/www.manageengine.com}                                                 |
                                                                                         |
+----------------------------------------------------------------------------------------+  
                                                                                         |   
--> TCP Connect/Full-Open Scan                                                           |
-->  nmap -sT -v 192.168.1.10                                                            |   
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |
--> Stealth Scan (Half-Open Scan):                                                       |
--> nmap -sS -v 192.168.11                                                               |   
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |   
--> Inverse TCP Flag Scan: Eficaz principalmente contra hosts que usam uma pilha TCP/IP  |   
derivada de BSD (não                                                                     |   
eficaz contra hosts Microsoft Windows, em particular).                                   |   
                                                                                         |   
-->nmap -sX -v 192.168.1.18                                                              |   
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |
--> TCP Maimon Scan:                                                                     |       
--> nmap -sM -v 192.168.1.12                                                             |   
                                                                                         |   
+-----------------------------------------------------------------------------------------
                                                                                         +   
--> ACK Flag Probe Scan:                                                                 |       
--> nmap -sA -v 192.168.1.12                                                             |   
                                                                                         |
+----------------------------------------------------------------------------------------+  
                                                                                         |   
--> IDLE/IPID Header Scan:                                                               |   
--> nmap -Pn -p- sI  192.168.1.12                                                        |   
                                                                                         |   
+-----------------------------------------------------------------------------------------
                                                                                         +   
--> UDPScan:                                                                             |   
--> nmap -sU -v  192.168.1.12                                                            |   
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |   
-->Varredura INIT:                                                                       |   
-->nmap -sY -v  192.168.1.12                                                             |   
                                                                                         |   
+----------------------------------------------------------------------------------------+
                                                                                         |   
--> SCTP COOKIE ECHO Scan:                                                               |   
--> nmap -sZ -v  192.168.1.12                                                            |
+----------------------------------------------------------------------------------------+
                                                                                         |   
--> SSDP and List Scan:                                                                  |   
--> nmap -sL -v 192.168.1.12                                                             |   
                                                                                         |   
+----------------------------------------------------------------------------------------+
                                                                                         |   
--> IPv6 Scan:                                                                           |   
--> nmap -6 google.com                                                                   |   
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |   
--> Service Version Discovery:                                                           |       
-->nmap -sV  192.168.1.12                                                                |   
                                                                                         |   
+----------------------------------------------------------------------------------------+   
                                                                                         |   
--> OS Discovery using Nmap Script Engine                                                |   
--> nmap --script smb-os-discovery.nse 192.168.1.12                                      |   
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |   
--> IDS/Firewall Evasion Techniques:                                                     |   
--> Varredura SYN/FIN usando fragmentos de IP:                                           |   
--> nmap -sS -T0 -A -f  -v 192.168.1.12                                                  |   
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |   
--> Manipulação da porta de origem:                                                      |   
--> nmap -g 80 192.168.1.12                                                              |   
                                                                                         |
+----------------------------------------------------------------------------------------+  
                                                                                         |   
--> IP Address Decoy:                                                                    |   
--> nmap -D RND:10 192.168.1.12                                                          |   
--> nmap -D decoy1,decoy2,decoy3, ... , ME, ... [target]                                 |   
Usando este comando, você pode especificar manualmente os endereços IP das iscas         |   
para verificar a rede da vítima. Aqui, você deve separar cada IP chamariz com uma        |   
vírgula (,) e opcionalmente pode usar o comando ME para posicionar seu IP real na lista  |   
de iscas. Se você colocar ME na 4ª posição do comando, seu IP real será posicionado na   |   
4ª posição respectivamente. Este é um comando opcional, e se você não mencionar ME       |   
em seu comando scan, o Nmap colocará automaticamente seu IP real em qualquer             |   
posição aleatória.                                                                       |   
■ Por exemplo, suponha que 10.10.1.19 seja o IP de origem real e 10.10.1.11 seja o       |   
endereço IP de destino a ser verificado. Então, o comando Nmap chamariz será:            |   
■ Sintaxe:                                                                               |   
# nmap -D 192.168.0.1,172.120.2.8,192.168.2.8,10.10.l.19,10.10.l.5                       |   
10.10.1.11                                                                               |   
+----------------------------------------------------------------------------------------+
                                                                                         |    
--> IP spoofing using Hping3:                                                            | 
--> Hping3 www.google.com -a 7.7.7.7                                                     | 
                                                                                         | 
--> Você pode usar o Hping3 para realizar falsificação de IP. O comando acima ajuda você | 
a enviar pacotes TCP/IP arbitrários para hosts de rede.                                  | 
Observação: você não conseguirá concluir o handshake triplo e abrir uma conexão TCP bem  |
sucedida com endereços IP falsificados.                                                  | 
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         |
--> Falsificação de endereço MAC:                                                        | 
                                                                                         | 
Os firewalls de rede filtram pacotes com base no endereço MAC (contrai de acesso à mídia)| 
de origem. Eles examinam o endereço MAC no cabeçalho do pacote e determinam se os pacotes|
são originários de uma fonte legítima. Os firewalls permitem o tráfego de fontes         |
específicas usando regras de filtragem MAC e restringem pacotes que não atendem às regras|
de filtragem. Para evitar essas restrições, os invasores usam técnicas de falsificação   |
de MAC, nas quais empregam endereços MAC falsos e se fazem passar por usuários legítimos | 
para verificar os hosts localizados atrás do firewall.                                   |
                                                                                         |
--> nmap -sT -Pn --spoof-mac O [Target IP]                                               |
+----------------------------------------------------------------------------------------+
                                                                                         |    
--> nmap -sT -Pn --spoof-mac [Vendor] [Target IP]                                        | 
                                                                                         | 
--> O comando acima permite que os invasores optem por um endereço MAC do vendedor       | 
e falsifiquem-no, anexando-o aos pacotes no lugar do endereço MAC original durante a     | 
varredura. Este tipo de varredura permite que os invasores façam a varredura no          | 
modo oculto, pois o endereço MAC original não é registrado nos logs do firewall. --      | 
spoof-rnac [vendor] representa a randomização do endereço MAC com base no vendar         | 
especificado.                                                                            |
                                                                                         |
+----------------------------------------------------------------------------------------+ 
                                                                                         | 
--> nmap -sT -Pn --spoof-mac [new MAC] [Target IP]                                       | 
                                                                                         | 
--> O comando acima permite que os invasores escolham ou definam manualmente um          | 
novo endereço MAC para os pacotes enviados durante o processo de varredura. --spoofmac   |
[novo MAC] representa a configuração manual do endereço MAC.                             |
                                                                                         |
+----------------------------------------------------------------------------------------+
                                                                                         | 
--> Randomizando a ordem do host e enviando somas de verificação incorretas              | 
Randomizando a ordem do host                                                             | 
O invasor verifica o número de hosts na rede alvo de forma aleatória para verificar o    |
alvo pretendido que está além do firewall. A opção usada pelo Nmap para fazer a varredura|
com um pedido de host aleatório é --randomize-hosts.                                     |    
Esta técnica instrui o Nmap a embaralhar cada grupo de 16.384 hosts antes da varredura   | 
com opções de tempo lento, tornando a varredura menos notável para sistemas de           | 
monitoramento de rede e firewalls.                                                       | 
                                                                                         | 
--> nmap -sT -Pn --randomize-hosts 192.168.1.12                                          |
+----------------------------------------------------------------------------------------+
                                                                                         | 
 --> Enviando somas de verificação incorretas:                                           | 
                                                                                         | 
O invasor envia pacotes com somas de verificação TCP/UPD incorretas ou falsas para o alvo|
pretendido para evitar determinados conjuntos de regras de firewall. As somas de         |  
verificação TCP/UPD são usadas para garantir a integridade dos dados. O envio de pacotes | 
com somas de verificação incorretas pode ajudar os invasores a adquirir informações de   | 
sistemas                                                                                 | 
configurados incorretamente, verificando qualquer resposta. Se houver resposta, então é  |
do                                                                                       |       
IDS ou firewall, que não verificou o checksum obtido. Se não houver resposta ou os       |
pacotes                                                                                  | 
forem descartados, pode-se inferir que o sistema está configurado. Esta técnica instrui o|
Nmap a enviar pacotes com checksums TCP, UDP ou SCTP inválidos para o host alvo. A opção |
usada pelo Nmap é --badsum.                                                              |
                                                                                         | 
--> nmap --badsum 192.168.1.12                                                           | 
+----------------------------------------------------------------------------------------+
                                                                                         | 
--> nmap –sS –p22 127.0.0.1                                                              | 
--> Este comando dirá ao nmap para executar um                                           | 
stealth SYN verifica sua interface de loopback para a porta 22 (SSH)                     |
                                                                                         | 
+----------------------------------------------------------------------------------------+
                                                                                         | 
--> DNSRecon.                                                                            | 
--> é um script avançado de enumeração de DNS escrito em Python.                        | 
Vamos executar o dnsrecon em megacorpone.com, usando a opção -d para especificar um nome |
de domínio e -t para especificar o tipo de enumeração a ser executada                    | 
(neste caso, uma varredura padrão).                                                      | 
                                                                                         | 
kali@kali:~$ dnsrecon -d megacorpone.com -t std                                          | 
                                                                                         | 
Para realizar nossa tentativa de força bruta, usaremos a opção -d para especificar       | 
um nome de domínio, -D para especificar um nome de arquivo contendo possíveis strings de |
subdomínio e -t para especificar o tipo de enumeração a ser executada,                   | 
neste caso brt para força bruta.                                                         | 
                                                                                         | 
kali@kali:~$ dnsrecon -d megacorpone.com -D ~/list.txt -t brt                            |
                                                                                         | 
Nossa tentativa de força bruta terminou e conseguimos resolver alguns nomes de host.     |   
DNSEnum é outra ferramenta popular de enumeração de DNS que pode ser usada para          | 
automatizar ainda mais a enumeração de DNS do domínio megacorpone.com. Podemos passar    | 
algumas opções para a ferramenta, mas para este exemplo passaremos apenas o parâmetro    | 
do domínio de destino:                                                                   | 
                                                                                         | 
kali@kali:~$ dnsenum megacorpone.com                                                     | 
                                                                                         | 
+----------------------------------------------------------------------------------------+
                                                                                         | 
Uma vez conectado ao cliente Windows 11, podemos executar uma consulta simples para      | 
resolver o registro A do host mail.megacorptwo.com.                                      | 
                                                                                         |     
--> C:\Users\hacking>nslookup mail.megacorptwo.com                                       | 
                                                                                         | 
Da mesma forma que o comando host do Linux, o nslookup pode realizar consultas mais      | 
granulares. Por exemplo, podemos consultar um determinado DNS sobre um registro TXT      | 
que pertence a um host específico.                                                       |     
                                                                                         |   
C:\Users\hacking>nslookup -type=TXT info.megacorptwo.com 192.168.50.151                  | 
                                                                                         | 
+----------------------------------------------------------------------------------------+
                                                                                         |
--> DESCOBRINDO HOSTS ATIVOS COM [PING SWEEP]                                            | 
                                                                                         | 
-->┌──(root㉿ENIAC)-[Xworm]                                                              | 
└─# for ip in $(seq 1 254);do ping -c 1 206.204.248.$ip;done | grep "64" bytes           | 
                                                                                         | 
+----------------------------------------------------------------------------------------+
                                                                                         | 
--> ENCONTRANDO HOSTS ATIVOS ATRAVÉS DO [ARP] {PENTEST INTERNO}                          | 
                                                                                         |   
--> arping -c 1 192.168.1.26                                                             | 
--> for ip in $(seq 1 34);do arping -c 1 192.168.1.$ip;done | grep "60 bytes"            |
--> arp-scan -l                                                                          |
                                                                                         |
+----------------------------------------------------------------------------------------+  
                                                                                         | 
--> O QUE FAZER QUANDO O ICMP ESTÁ BLOQUEADO?                                            | 
--> nmap -sn 192.168.1.12/24                                                             |   
-->nmap -sn 192.168.1.12/24 -oG hostsativos                                              | 
                                                                                         |       
+----------------------------------------------------------------------------------------+                                                                                         