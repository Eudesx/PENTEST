O que é enumeração?

Enumeração é o processo de extrair nomes de usuários, nomes de máquinas, recursos de rede, 
compartilhamentos e serviços de um sistema ou rede. Na fase de enumeração, 
um invasor cria conexões ativas com o sistema e envia consultas direcionadas 
para obter mais informações sobre o alvo. O invasor usa as informações coletadas por meio de enumeração
para identificar vulnerabilidades na segurança do sistema, o que o ajuda a explorar o sistema alvo. 
Por sua vez, a enumeração permite que o invasor execute ataques de senha para obter acesso não autorizado
aos recursos do sistema de informação. As técnicas de enumeração funcionam em um ambiente de intranet.
Em particular, a enumeração permite ao invasor coletar as seguintes informações:

Recursos de rede.
Compartilhamento de rede.
Tabela de roteamento
Configurações de auditoria e serviço.
Detalhes de SNMP e nomes de domínio totalmento qualificado (FQDN)
Nomes de máquinas.
Usuários e grupos.
Aplicativos e banners.

Durante a enumeração, os invasores podem se deparar com um compartilhamento de comunicação remota entre processos (IPC)
como o IPC$ no Windows, que podem investigar ainda mais para se conectar a um compartilhamento administrativo forçando
credenciais de administrador e obter informações completas sobre o arquivo. listagem do sistema que o compartilhamento 
representa.

+-------------------------------------------------------------------------------------------------------------------------+

ENUMERAÇÃO HTTP:

┌──(root㉿ENIAC)-[/home/]
└─# nc -v blabla.com.br 80
fwd/rev mismatch: blabla.com.br != ip555.ip-27-00-10.eu
Tblabla.com.br [192.168.1.254] 80 (http) open
HEAD / HTTP/1.0

HTTP/1.1 408 Request Time-out
Date: Sat, 28 Sep 2019 13:57:22 GMT
Server: Apache/2.2.22 (Debian) --> VERSÃO DO SERVER
Vary: Accept-Encoding
Connection: close
Content-Type: text/html; charset=iso-8859-1


┌──(root㉿ENIAC)-[/home/]
└─# nc -v blabla.com.br 80
fwd/rev mismatch: blabla.com.br != ip555.ip-27-00-10.eu
Tblabla.com.br [192.168.1.254] 80 (http) open
OPTIONS /admin HTTP/1.0

HTTP/1.1 200 OK
Date: Sat, 28 Sep 2019 13:57:22 GMT
Server: Apache/2.2.22 (Debian) --> "VERSÃO DO SERVER"
Allow: OPTIONS,GET,HEAD,POST --> "METODOS PERMITIDOS" 
Vary: Accept-Encoding
Connection: close
Content-Type: text/html; charset=iso-8859-1

┌──(root㉿ENIAC)-[/home/]
└─# nc -v blabla.com.br 80
fwd/rev mismatch: blabla.com.br != ip555.ip-27-00-10.eu
Tblabla.com.br [192.168.1.254] 80 (http) open
GET / HTTP/1.1 --> "UTILIZAR o  HTTP/1.1 Para hosts que hospedam muitos sites para retornar mais informações"
HOST: blabla.com.br --> "Não esquecer de especificar o host."

HTTP/1.1 408 Request Time-out
Date: Sat, 28 Sep 2019 13:57:22 GMT
Server: Apache/2.2.22 (Debian) --> VERSÃO DO SERVER
Vary: Accept-Encoding
Connection: close
Content-Type: text/html; charset=iso-8859-1

┌──(root㉿ENIAC)-[/home/]
└─# nc -v blabla.com.br 80
fwd/rev mismatch: blabla.com.br != ip555.ip-27-00-10.eu
Tblabla.com.br [192.168.1.254] 80 (http) open
GET /index.aspx HTTP/1.0 --> "Retorna a versão da tecnologia"

XAspNet-Version: 2.0.50727 --> "Versão"
HTTP/1.1 408 Request Time-out
Date: Sat, 28 Sep 2019 13:57:22 GMT
Server: Apache/2.2.22 (Debian) --> VERSÃO DO SERVER
Vary: Accept-Encoding
Connection: close
Content-Type: text/html; charset=iso-8859-1

+--------------------------------------------------------------------------------------------+

ENUMERAÇÃO EM HTTPS:

┌──(root㉿ENIAC)-[/home]
└─# openssl s_client -quiet -connect tesla.com:443
depth=2 C = US, O = DigiCert Inc, OU = www.digicert.com, CN = DigiCert Global Root CA
verify return:1
depth=1 C = US, O = DigiCert Inc, OU = www.digicert.com, CN = GeoTrust RSA CA 2018
verify return:1
depth=0 C = US, ST = Texas, L = Austin, O = "TESLA, INC.", CN = *.tesla.com
verify return:1
HEAD / HTTP1.1
Host: tesla.com

+--------------------------------------------------------------------------------------------------+

IDENTIFICANDO [ WEB APPLICATION FIREWALL ]

┌──(root㉿ENIAC)-[/home/hashirama]
└─# wafw00f -v -a https://blabla.com.br  

                   ______
                  /      \                                                                                               
                 (  Woof! )                                                                                              
                  \  ____/                      )                                                                        
                  ,,                           ) (_                                                                      
             .-. -    _______                 ( |__|                                                                     
            ()``; |==|_______)                .)|__|                                                                     
            / ('        /|\                  (  |__|                                                                     
        (  /  )        / | \                  . |__|                                                                     
         \(_)_))      /  |  \                   |__|                                                                     

                    ~ WAFW00F : v2.2.0 ~
    The Web Application Firewall Fingerprinting Toolkit                                                                  
                                                                                                                         
[*] Checking https://blabla.com.br
[+] The site https://blabla.com.br is behind Kona SiteDefender (Akamai) WAF.
[~] Number of requests: 2

+-------------------------------------------------------------------------------------------------------------+

ENUMERANDO FILE TRANSFER PROTOCOL(FTP)

'┌──(root㉿ENIAC)-[/home/]
└─# nmap -v -sV -p21,2121 -Pn --open 192.168.1.26/24 -oG ftp
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower.
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-04-30 19:11 -03
NSE: Loaded 46 scripts for scanning.
Initiating ARP Ping Scan at 19:11
Scanning 255 hosts [1 port/host]
Completed ARP Ping Scan at 19:11, 22.56s elapsed (255 total hosts)
Initiating Parallel DNS resolution of 5 hosts. at 19:11
Completed Parallel DNS resolution of 5 hosts. at 19:11, 0.01s elapsed
Initiating Parallel DNS resolution of 1 host. at 19:11
Completed Parallel DNS resolution of 1 host. at 19:11, 0.01s elapsed
Initiating SYN Stealth Scan at 19:11
Scanning 5 hosts [2 ports/host]
Discovered open port 21/tcp on 192.168.1.26
Discovered open port 2121/tcp on 192.168.1.26
Completed SYN Stealth Scan at 19:11, 1.80s elapsed (10 total ports)
Initiating Service scan at 19:11
Scanning 2 services on 5 hosts
Completed Service scan at 19:11, 5.03s elapsed (2 services on 5 hosts)
NSE: Script scanning 5 hosts.
Initiating NSE at 19:11
Completed NSE at 19:11, 0.04s elapsed
Initiating NSE at 19:11
Completed NSE at 19:11, 0.01s elapsed
Nmap scan report for 192.168.1.26
Host is up (0.00056s latency).

PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 2.3.4
2121/tcp open  ftp     ProFTPD 1.3.1
MAC Address: 08:00:27:7B:88:8B (Oracle VirtualBox virtual NIC)
Service Info: OS: Unix

Initiating SYN Stealth Scan at 19:11
Scanning 192.168.1.13 [2 ports]
Completed SYN Stealth Scan at 19:11, 0.02s elapsed (2 total ports)
Initiating Service scan at 19:11
NSE: Script scanning 192.168.1.13.
Initiating NSE at 19:11
Completed NSE at 19:11, 0.00s elapsed
Initiating NSE at 19:11
Completed NSE at 19:11, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 256 IP addresses (6 hosts up) scanned in 30.91 seconds
           Raw packets sent: 534 (15.208KB) | Rcvd: 19 (668B)

+---------------------------------------------------------------------------------------------------+
INTERAGINDO COM O FTP:

┌──(root㉿ENIAC)-[/home/]
└─# nc -vn 192.168.1.26 2121                                    
(UNKNOWN) [192.168.1.26] 2121 (iprop) open
220 ProFTPD 1.3.1 Server (Debian) [192.168.1.26]

┌──(root㉿ENIAC)-[/home/]
└─# nc -vn 192.168.1.26 2121
(UNKNOWN) [192.168.1.26] 2121 (iprop) open
220 ProFTPD 1.3.1 Server (Debian) [192.168.1.26]
USER banana
331 Password required for msfadmin
PASS banana123
230 User banana logged in
QUIT
221 Goodbye.

┌──(root㉿ENIAC)-[/home/]
└─# ftp 192.168.1.26
Connected to 192.168.1.26.
220 (vsFTPd 2.3.4)
Name (192.168.1.26:banana): admin
331 Please specify the password.
Password: 
530 Login incorrect.
ftp: Login failed
ftp> 

┌──(root㉿ENIAC)-[/home/]
└─# ftp 192.168.1.26
Connected to 192.168.1.26.
220 (vsFTPd 2.3.4)
Name (192.168.1.26:hashirama): anonymous
331 Please specify the password.
Password: 
230 Login successful.
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> pwd
Remote directory: /
ftp> passive
Passive mode: off; fallback to active mode: off.
ftp> passive
Passive mode: on; fallback to active mode: on.
ftp> ls
229 Entering Extended Passive Mode (|||63876|).
150 Here comes the directory listing.
226 Directory send OK.
ftp> 

+----------------------------------------------------------------------------------------+

ENUMERANDO NetBIOS / SMB ATRAVÉS DO WINDOWS:


C:\Windows\system32>nbtstat -A 192.168.1.36

Ethernet 2:
Endereço-Ip nó: [192.168.56.1] Identificador de escopo: []

    Host não encontrado.

Ethernet 3:
Endereço-Ip nó: [192.168.1.29] Identificador de escopo: []

           Tabela de nomes de máquinas remotas de NetBIOS

       Nome               Tipo         Status
    ---------------------------------------------
    DESKTOP-ET4LE3E<00>  EXCLUSIVO   Registrado
    DESKTOP-ET4LE3E<20>  EXCLUSIVO   Registrado
    WORKGROUP      <00>  GRUPO       Registrado

    Endereço MAC = 00-00-00-00-00-00

    
C:\Windows\system32>net view \\192.168.1.36
Erro de sistema 5.

Acesso negado.

null sesion:

C:\Windows\system32>net use \\192.168.1.26 "" /u: ""

Com Autenticação:

C:\Windows\system32>net use \\192.168.1.36 "Admin123" /u:"MALWARE"
Comando concluído com êxito.


C:\Windows\system32>net use
Novas conexões serão lembradas.


Status       Local     Remoto                    Rede

-------------------------------------------------------------------------------
OK                     \\192.168.1.36\IPC$       Microsoft Windows Network
Comando concluído com êxito.

C:\Windows\system32>nbtstat -c

Ethernet 2:
Endereço-Ip nó: [192.168.56.1] Identificador de escopo: []

    Não há nomes no cache

Ethernet 3:
Endereço-Ip nó: [192.168.1.29] Identificador de escopo: []

                  Tabela de nomes de caches remotas de NetBIOS

        Nome              Tipo       Endereço Host   Duração [seg]
    ---------------------------------------------------------------
    METASPLOITABLE <20>  EXCLUSIVO       192.168.1.26        375

+---------------------------------------------------------------------------------+
    
C:\Windows\system32>net use
Novas conexões serão lembradas.


Status       Local     Remoto                    Rede

-------------------------------------------------------------------------------
OK                     \\192.168.1.36\IPC$       Microsoft Windows Network
Comando concluído com êxito.


C:\Windows\system32>net view \\192.168.1.36
Recursos compartilhados em \\192.168.1.36



Nome do compartilhamento  Tipo   Usado como  Comentário

-------------------------------------------------------------------------------
Diretorio Raiz            Disco
Users                     Disco
Comando concluído com êxito.

+-----------------------------------------------------------------------------------+

C:\Windows\system32>net use h: \\192.168.1.36\Users
Comando concluído com êxito.

C:\Windows\system32>net use
Novas conexões serão lembradas.


Status       Local     Remoto                    Rede

-------------------------------------------------------------------------------
OK           H:        \\192.168.1.36\Users      Microsoft Windows Network
OK                     \\192.168.1.36\IPC$       Microsoft Windows Network
Comando concluído com êxito.


C:\Windows\system32>h:

H:\>dir
 O volume na unidade H não tem nome.
 O Número de Série do Volume é DAE0-3D5B

 Pasta de H:\

20/04/2024  19:52    <DIR>          .
20/04/2024  19:52    <DIR>          ..
09/04/2024  15:08    <DIR>          MALWARE
09/04/2024  15:06    <DIR>          Public
               0 arquivo(s)              0 bytes
               4 pasta(s)   27.607.502.848 bytes disponíveis

+----------------------------------------------------------------------------------------------+

ENUMERAÇÃO NetBIOS / SMB / BRUTE FORCE SMB/NETBIOS NO PROMPT DO WINDOWS:

C:\>for /f %i in (senhas.txt) do net use \\192.168.1.26 %i /u:MALWARE
C:\>net use \\192.168.1.26 root123 /u:MALWARE
The command completed successfully.

net use \\192.168.1.26 /delete
C:\>for /f "tokens=1,2" %i in (senhas.txt) do net use \\192.168.1.26 %j /u:%i --> Brute force com usuario e senha.

USAR VESÃO MAIS ANTIGA SMB:

┌──(root㉿ENIAC)-[/home/]
└─# smbclient -L \\192.168.1.26 -N --option='client min protocol=NT1'
Anonymous login successful

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        tmp             Disk      oh noes!
        opt             Disk      
        IPC$            IPC       IPC Service (metasploitable server (Samba 3.0.20-Debian))
        ADMIN$          IPC       IPC Service (metasploitable server (Samba 3.0.20-Debian))
Reconnecting with SMB1 for workgroup listing.
Anonymous login successful

        Server               Comment
        ---------            -------

        Workgroup            Master
        ---------            -------
        WORKGROUP            METASPLOITABLE

+--------------------------------------------------------------------------------------------------------+

ENUMERAÇÃO NETBIOS/SMB ATRAVÉS DO LINUX:        

┌──(root㉿ENIAC)-[/home/]
└─# nbtscan -r 192.168.1.254/24
Doing NBT name scan for addresses from 192.168.1.254/24

IP address       NetBIOS Name     Server    User             MAC address      
------------------------------------------------------------------------------
192.168.1.13     <unknown>                  <unknown>        
192.168.1.29     DESKTOP-6BKDN3V  <server>  <unknown>        03:04:05:06:07:80
192.168.1.36     DESKTOP-ET4LE3E  <server>  <unknown>        02:03:04:05:06:07
192.168.1.26     METASPLOITABLE   <server>  METASPLOITABLE   01:01:01:01:00:00
192.168.1.255   Sendto failed: Permission denied
                                                                                                                         
┌──(root㉿ENIAC)-[/home/]
└─# smbclient -L \\192.168.1.26                                       
Password for [WORKGROUP\root]:
Anonymous login successful

        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        tmp             Disk      oh noes!
        opt             Disk      
        IPC$            IPC       IPC Service (metasploitable server (Samba 3.0.20-Debian))
        ADMIN$          IPC       IPC Service (metasploitable server (Samba 3.0.20-Debian))
Reconnecting with SMB1 for workgroup listing.
Anonymous login successful

        Server               Comment
        ---------            -------

        Workgroup            Master
        ---------            -------
        WORKGROUP            METASPLOITABLE
+-------------------------------------------------------------------------------------------------------+

ENUMERAÇÃO COM RPCCLIENT:

                                                                                                                         
┌──(root㉿ENIAC)-[/home/]
└─# rpcclient -U "" -N 192.168.1.26
rpcclient $> enumdomusers
user:[games] rid:[0x3f2]
user:[nobody] rid:[0x1f5]
user:[bind] rid:[0x4ba]
user:[proxy] rid:[0x402]
user:[syslog] rid:[0x4b4]
user:[user] rid:[0xbba]
user:[www-data] rid:[0x42a]
user:[root] rid:[0x3e8]
user:[news] rid:[0x3fa]
user:[postgres] rid:[0x4c0]
user:[bin] rid:[0x3ec]
user:[mail] rid:[0x3f8]
user:[distccd] rid:[0x4c6]
user:[proftpd] rid:[0x4ca]
user:[dhcp] rid:[0x4b2]
user:[daemon] rid:[0x3ea]
user:[sshd] rid:[0x4b8]
user:[man] rid:[0x3f4]
user:[lp] rid:[0x3f6]
user:[mysql] rid:[0x4c2]
user:[gnats] rid:[0x43a]
user:[libuuid] rid:[0x4b0]
user:[backup] rid:[0x42c]
user:[msfadmin] rid:[0xbb8]
user:[telnetd] rid:[0x4c8]
user:[sys] rid:[0x3ee]
user:[klog] rid:[0x4b6]
user:[postfix] rid:[0x4bc]
user:[service] rid:[0xbbc]
user:[list] rid:[0x434]
user:[irc] rid:[0x436]
user:[ftp] rid:[0x4be]
user:[tomcat55] rid:[0x4c4]
user:[sync] rid:[0x3f0]
user:[uucp] rid:[0x3fc]
rpcclient $> 

┌──(root㉿ENIAC)-[/home/]
└─# rpcclient -U "" -N 192.168.1.26
rpcclient $> queryuser root
        User Name   :   root
        Full Name   :   root
        Home Drive  :   \\metasploitable\root
        Dir Drive   :
        Profile Path:   \\metasploitable\root\profile
        Logon Script:
        Description :
        Workstations:
        Comment     :   (null)
        Remote Dial :
        Logon Time               :      Wed, 31 Dec 1969 21:00:00 -03
        Logoff Time              :      Wed, 13 Sep 30828 23:48:05 -03
        Kickoff Time             :      Wed, 13 Sep 30828 23:48:05 -03
        Password last set Time   :      Wed, 31 Dec 1969 21:00:00 -03
        Password can change Time :      Wed, 31 Dec 1969 21:00:00 -03
        Password must change Time:      Wed, 13 Sep 30828 23:48:05 -03
        unknown_2[0..31]...
        user_rid :      0x3e8
        group_rid:      0x3e9
        acb_info :      0x00000011
        fields_present: 0x00ffffff
        logon_divs:     168
        bad_password_count:     0x00000000
        logon_count:    0x00000000
        padding1[0..7]...
        logon_hrs[0..21]...
rpcclient $> 

+-----------------------------------------------------------------------------------------------------------+

ENUMERAÇÃO SMB/NETBIOS COM ENUM4LINUX:

┌──(root㉿ENIAC)-[/home/]
└─# enum4linux -U 192.168.1.26
Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Tue May  7 19:57:47 2024

 =========================================( Target Information )=========================================
                                                                                                                         
Target ........... 192.168.1.26                                                                                          
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ============================( Enumerating Workgroup/Domain on 192.168.1.26 )============================
                                                                                                                         
                                                                                                                         
[+] Got domain/workgroup name: WORKGROUP                                                                                 
                                                                                                                         
                                                                                                                         
 ===================================( Session Check on 192.168.1.26 )===================================
                                                                                                                         
                                                                                                                         
[+] Server 192.168.1.26 allows sessions using username '', password ''                                                   
                                                                                                                         
                                                                                                                         
 ================================( Getting domain SID for 192.168.1.26 )================================
                                                                                                                         
Domain Name: WORKGROUP                                                                                                   
Domain Sid: (NULL SID)

'[+] Can't determine if host is part of domain or part of a workgroup                                                     
                                                                                                                         
                                                                                                                         
 =======================================( Users on 192.168.1.26 )=======================================
                                                                                                                         
index: 0x1 RID: 0x3f2 acb: 0x00000011 Account: games    Name: games     Desc: (null)                                     
index: 0x2 RID: 0x1f5 acb: 0x00000011 Account: nobody   Name: nobody    Desc: (null)
index: 0x3 RID: 0x4ba acb: 0x00000011 Account: bind     Name: (null)    Desc: (null)
index: 0x4 RID: 0x402 acb: 0x00000011 Account: proxy    Name: proxy     Desc: (null)
index: 0x5 RID: 0x4b4 acb: 0x00000011 Account: syslog   Name: (null)    Desc: (null)
index: 0x6 RID: 0xbba acb: 0x00000010 Account: user     Name: just a user,111,, Desc: (null)
index: 0x7 RID: 0x42a acb: 0x00000011 Account: www-data Name: www-data  Desc: (null)
index: 0x8 RID: 0x3e8 acb: 0x00000011 Account: root     Name: root      Desc: (null)
index: 0x9 RID: 0x3fa acb: 0x00000011 Account: news     Name: news      Desc: (null)
index: 0xa RID: 0x4c0 acb: 0x00000011 Account: postgres Name: PostgreSQL administrator,,,       Desc: (null)
index: 0xb RID: 0x3ec acb: 0x00000011 Account: bin      Name: bin       Desc: (null)
index: 0xc RID: 0x3f8 acb: 0x00000011 Account: mail     Name: mail      Desc: (null)
index: 0xd RID: 0x4c6 acb: 0x00000011 Account: distccd  Name: (null)    Desc: (null)
index: 0xe RID: 0x4ca acb: 0x00000011 Account: proftpd  Name: (null)    Desc: (null)
index: 0xf RID: 0x4b2 acb: 0x00000011 Account: dhcp     Name: (null)    Desc: (null)
index: 0x10 RID: 0x3ea acb: 0x00000011 Account: daemon  Name: daemon    Desc: (null)
index: 0x11 RID: 0x4b8 acb: 0x00000011 Account: sshd    Name: (null)    Desc: (null)
index: 0x12 RID: 0x3f4 acb: 0x00000011 Account: man     Name: man       Desc: (null)
index: 0x13 RID: 0x3f6 acb: 0x00000011 Account: lp      Name: lp        Desc: (null)
index: 0x14 RID: 0x4c2 acb: 0x00000011 Account: mysql   Name: MySQL Server,,,   Desc: (null)
index: 0x15 RID: 0x43a acb: 0x00000011 Account: gnats   Name: Gnats Bug-Reporting System (admin)        Desc: (null)
index: 0x16 RID: 0x4b0 acb: 0x00000011 Account: libuuid Name: (null)    Desc: (null)
index: 0x17 RID: 0x42c acb: 0x00000011 Account: backup  Name: backup    Desc: (null)
index: 0x18 RID: 0xbb8 acb: 0x00000010 Account: msfadmin        Name: msfadmin,,,       Desc: (null)
index: 0x19 RID: 0x4c8 acb: 0x00000011 Account: telnetd Name: (null)    Desc: (null)
index: 0x1a RID: 0x3ee acb: 0x00000011 Account: sys     Name: sys       Desc: (null)
index: 0x1b RID: 0x4b6 acb: 0x00000011 Account: klog    Name: (null)    Desc: (null)
index: 0x1c RID: 0x4bc acb: 0x00000011 Account: postfix Name: (null)    Desc: (null)
index: 0x1d RID: 0xbbc acb: 0x00000011 Account: service Name: ,,,       Desc: (null)
index: 0x1e RID: 0x434 acb: 0x00000011 Account: list    Name: Mailing List Manager      Desc: (null)
index: 0x1f RID: 0x436 acb: 0x00000011 Account: irc     Name: ircd      Desc: (null)
index: 0x20 RID: 0x4be acb: 0x00000011 Account: ftp     Name: (null)    Desc: (null)
index: 0x21 RID: 0x4c4 acb: 0x00000011 Account: tomcat55        Name: (null)    Desc: (null)
index: 0x22 RID: 0x3f0 acb: 0x00000011 Account: sync    Name: sync      Desc: (null)
index: 0x23 RID: 0x3fc acb: 0x00000011 Account: uucp    Name: uucp      Desc: (null)

user:[games] rid:[0x3f2]
user:[nobody] rid:[0x1f5]
user:[bind] rid:[0x4ba]
user:[proxy] rid:[0x402]
user:[syslog] rid:[0x4b4]
user:[user] rid:[0xbba]
user:[www-data] rid:[0x42a]
user:[root] rid:[0x3e8]
user:[news] rid:[0x3fa]
user:[postgres] rid:[0x4c0]
user:[bin] rid:[0x3ec]
user:[mail] rid:[0x3f8]
user:[distccd] rid:[0x4c6]
user:[proftpd] rid:[0x4ca]
user:[dhcp] rid:[0x4b2]
user:[daemon] rid:[0x3ea]
user:[sshd] rid:[0x4b8]
user:[man] rid:[0x3f4]
user:[lp] rid:[0x3f6]
user:[mysql] rid:[0x4c2]
user:[gnats] rid:[0x43a]
user:[libuuid] rid:[0x4b0]
user:[backup] rid:[0x42c]
user:[msfadmin] rid:[0xbb8]
user:[telnetd] rid:[0x4c8]
user:[sys] rid:[0x3ee]
user:[klog] rid:[0x4b6]
user:[postfix] rid:[0x4bc]
user:[service] rid:[0xbbc]
user:[list] rid:[0x434]
user:[irc] rid:[0x436]
user:[ftp] rid:[0x4be]
user:[tomcat55] rid:[0x4c4]
user:[sync] rid:[0x3f0]
user:[uucp] rid:[0x3fc]
enum4linux complete on Tue May  7 19:57:48 2024

┌──(root㉿ENIAC)-[/home/]
└─# enum4linux -S 192.168.1.26
Starting enum4linux v0.9.1 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Tue May  7 20:01:21 2024

 =========================================( Target Information )=========================================
                                                                                                                         
Target ........... 192.168.1.26                                                                                          
RID Range ........ 500-550,1000-1050
Username ......... ''
Password ......... ''
Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none


 ============================( Enumerating Workgroup/Domain on 192.168.1.26 )============================
                                                                                                                         
                                                                                                                         
[+] Got domain/workgroup name: WORKGROUP                                                                                 
                                                                                                                         
                                                                                                                         
 ===================================( Session Check on 192.168.1.26 )===================================
                                                                                                                         
                                                                                                                         
[+] Server 192.168.1.26 allows sessions using username '', password ''                                                   
                                                                                                                         
                                                                                                                         
 ================================( Getting domain SID for 192.168.1.26 )================================
                                                                                                                         
Domain Name: WORKGROUP                                                                                                   
Domain Sid: (NULL SID)

[+] Can't determine if host is part of domain or part of a workgroup                                                     
                                                                                                                         
                                                                                                                         
 =================================( Share Enumeration on 192.168.1.26 )=================================
                                                                                                                         
                                                                                                                         
        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        tmp             Disk      oh noes!
        opt             Disk      
        IPC$            IPC       IPC Service (metasploitable server (Samba 3.0.20-Debian))
        ADMIN$          IPC       IPC Service (metasploitable server (Samba 3.0.20-Debian))
Reconnecting with SMB1 for workgroup listing.

        Server               Comment
        ---------            -------

        Workgroup            Master
        ---------            -------
        WORKGROUP            METASPLOITABLE

[+] Attempting to map shares on 192.168.1.26                                                                             
                                                                                                                         
//192.168.1.26/print$   Mapping: DENIED Listing: N/A Writing: N/A                                                        
//192.168.1.26/tmp      Mapping: OK Listing: OK Writing: N/A
//192.168.1.26/opt      Mapping: DENIED Listing: N/A Writing: N/A

[E] Can't understand response:                                                                                           
                                                                                                                         
NT_STATUS_NETWORK_ACCESS_DENIED listing \*                                                                               
//192.168.1.26/IPC$     Mapping: N/A Listing: N/A Writing: N/A
//192.168.1.26/ADMIN$   Mapping: DENIED Listing: N/A Writing: N/A
enum4linux complete on Tue May  7 20:01:22 2024

+------------------------------------------------------------------------------------------------+

SCRIPTS PARA ENUMERAÇÃO NetBios / SMB:

┌──(root㉿ENIAC)-[/home/]
└─# ls /usr/share/nmap/scripts/ --> Diretorio de scripts do nmap.

┌──(root㉿ENIAC)-[/home/]
└─# nmap  --script=smb-os-discovery 192.168.1.26 
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-09 19:16 -03
Nmap scan report for 192.168.1.26
Host is up (0.00029s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address: 00:00:00:00:00:00 (Oracle VirtualBox virtual NIC)

Host script results:
| smb-os-discovery: 
|   OS: Unix (Samba 3.0.20-Debian)
|   Computer name: metasploitable
|   NetBIOS computer name: 
|   Domain name: localdomain
|   FQDN: metasploitable.localdomain
|_  System time: 2024-04-27T03:44:57-04:00

┌──(root㉿ENIAC)-[/home/]
└─# nmap  --script=smb-vuln-ms* 192.168.1.26    
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-09 19:18 -03
Nmap scan report for 192.168.1.26
Host is up (0.00024s latency).
Not shown: 977 closed tcp ports (reset)
PORT     STATE SERVICE
21/tcp   open  ftp
22/tcp   open  ssh
23/tcp   open  telnet
25/tcp   open  smtp
53/tcp   open  domain
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
512/tcp  open  exec
513/tcp  open  login
514/tcp  open  shell
1099/tcp open  rmiregistry
1524/tcp open  ingreslock
2049/tcp open  nfs
2121/tcp open  ccproxy-ftp
3306/tcp open  mysql
5432/tcp open  postgresql
5900/tcp open  vnc
6000/tcp open  X11
6667/tcp open  irc
8009/tcp open  ajp13
8180/tcp open  unknown
MAC Address:  (Oracle VirtualBox virtual NIC)

Host script results:
|_smb-vuln-ms10-054: false
|_smb-vuln-ms10-061: false

+-------------------------------------------------------------------------------------+

ENUMERAÇÃO POP3 - PORTA 110:

┌──(root㉿ENIAC)-[/home/]
└─# nmap --open -sS -p 110 -Pn 192.168.1.36 --> Descobrir hosts com a porta 110 aberta

+---------------------------------------------------------------------------------------+

ENUMERAÇÃO SMTP - PORTA 25:

┌──(root㉿ENIAC)-[/home/hashirama]
└─# nmap --open -sS -p 25 -Pn 192.168.1.26
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-09 19:41 -03
Nmap scan report for 192.168.1.26
Host is up (0.00031s latency).

PORT   STATE SERVICE
25/tcp open  smtp
MAC Address:  (Oracle VirtualBox virtual NIC)

                                                                                                                         
┌──(root㉿ENIAC)-[/home/]
└─# nc 192.168.1.26 25                       
220 metasploitable.localdomain ESMTP Postfix (Ubuntu)
HELO metasploitable
250 metasploitable.localdomain
EHLO metasploitable
250-metasploitable.localdomain
250-PIPELINING
250-SIZE 10240000
250-VRFY
250-ETRN
250-STARTTLS
250-ENHANCEDSTATUSCODES
250-8BITMIME
250 DSN
HELP
502 5.5.2 Error: command not recognized
VRFY msfadmin
252 2.0.0 msfadmin
VRFY banana
550 5.1.1 <banana>: Recipient address rejected: User unknown in local recipient table

+-----------------------------------------------------------------------------------------+

CRIANDO UM SCRIP PARA ENUMERAR SMTP:

#!/usr/bin/python
import socket, sys
from colorama import Fore

if len(sys.argv) != 3:
        print(Fore.MAGENTA+'MODO de uso: python3 smtpenum.py IP usuario')
        sys.exit(0)
# Cria a conexão com o host
tcp = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
tcp.connect((sys.argv[1].encode(), 25))
banner = tcp.recv(1024)
print(banner.decode())
# Envia comandos para o host
comando = b'VRFY root'+ sys.argv[2].encode() + b'\r\n'
tcp.send(comando)
user = tcp.recv(1024)
print(user.decode())

+-----------------------------------------------------------------------------------------------+

ENUMERANDO TELNET PORTA 23 ROUTERS / SWITCHS / FIREWALLS

 nmap --open -sS -p 23 -Pn 192.168.1.0/24   
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-16 20:26 -03
Nmap scan report for 192.168.1.26
Host is up (0.00061s latency).

PORT   STATE SERVICE
23/tcp open  telnet
MAC Address: 00:00:00:00:00:00 (Oracle VirtualBox virtual NIC)

+------------------------------------------------------------------------------------------------+

──(root㉿ENIAC)-[/home/]
└─# telnet 192.168.1.26
Trying 192.168.1.26...
Connected to 192.168.1.26.
Escape character is '^].
                _                  _       _ _        _     _      ____  
 _ __ ___   ___| |_ __ _ ___ _ __ | | ___ (_) |_ __ _| |__ | | ___|___ \ 
| '_ ` _ \ / _ \ __/ _` / __| '_ \| |/ _ \| | __/ _` | '_ \| |/ _ \ __) |
| | | | | |  __/ || (_| \__ \ |_) | | (_) | | || (_| | |_) | |  __// __/ 
|_| |_| |_|\___|\__\__,_|___/ .__/|_|\___/|_|\__\__,_|_.__/|_|\___|_____|
                            |_|                                          


Warning: Never expose this VM to an untrusted network!

Contact: msfdev[at]metasploit.com

Login with msfadmin/msfadmin to get started


metasploitable login: msfadmin
Password: 
Last login: Fri Apr 26 18:04:13 EDT 2024 on tty1
Linux metasploitable 2.6.24-16-server #1 SMP Thu Apr 10 13:58:00 UTC 2008 i686

The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

To access official Ubuntu documentation, please visit:
http://help.ubuntu.com/
No mail.
msfadmin@metasploitable:~$ pwd
/home/msfadmin
msfadmin@metasploitable:~$ 

+---------------------------------------------------------------------------------+

ENUMERANDO SSH PORTA 22:

┌──(root㉿ENIAC)-[/home/]
└─# nmap --open -sS -p22,2222 -Pn 192.168.1.0/24
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-16 20:47 -03
Nmap scan report for 192.168.1.26
Host is up (0.00047s latency).
Not shown: 1 closed tcp port (reset)
PORT   STATE SERVICE
22/tcp open  ssh

+-----------------------------------------------------------------------------------+

┌──(root㉿ENIAC)-[/home/]
└─# nc 192.168.1.26 22                          
SSH-2.0-OpenSSH_4.7p1 Debian-8ubuntu1

+------------------------------------------------------------------------------------+

┌──(root㉿ENIAC)-[/home/]
└─# ssh -v 192.168.1.26 22
OpenSSH_9.6p1 Debian-4, OpenSSL 3.1.5 30 Jan 2024
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files
debug1: /etc/ssh/ssh_config line 21: Applying options for *
debug1: Connecting to 192.168.1.26 [192.168.1.26] port 22.
debug1: Connection established.
debug1: identity file /root/.ssh/id_rsa type -1
debug1: identity file /root/.ssh/id_rsa-cert type -1
debug1: identity file /root/.ssh/id_ecdsa type -1
debug1: identity file /root/.ssh/id_ecdsa-cert type -1
debug1: identity file /root/.ssh/id_ecdsa_sk type -1
debug1: identity file /root/.ssh/id_ecdsa_sk-cert type -1
debug1: identity file /root/.ssh/id_ed25519 type -1
debug1: identity file /root/.ssh/id_ed25519-cert type -1
debug1: identity file /root/.ssh/id_ed25519_sk type -1
debug1: identity file /root/.ssh/id_ed25519_sk-cert type -1
debug1: identity file /root/.ssh/id_xmss type -1
debug1: identity file /root/.ssh/id_xmss-cert type -1
debug1: identity file /root/.ssh/id_dsa type -1
debug1: identity file /root/.ssh/id_dsa-cert type -1
debug1: Local version string SSH-2.0-OpenSSH_9.6p1 Debian-4
debug1: Remote protocol version 2.0, remote software version OpenSSH_4.7p1 Debian-8ubuntu1
debug1: compat_banner: match: OpenSSH_4.7p1 Debian-8ubuntu1 pat OpenSSH_2*,OpenSSH_3*,OpenSSH_4* compat 0x00000002
debug1: Authenticating to 192.168.1.26:22 as 'root'
debug1: load_hostkeys: fopen /root/.ssh/known_hosts: No such file or directory
debug1: load_hostkeys: fopen /root/.ssh/known_hosts2: No such file or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts: No such file or directory
debug1: load_hostkeys: fopen /etc/ssh/ssh_known_hosts2: No such file or directory
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: algorithm: diffie-hellman-group-exchange-sha256
debug1: kex: host key algorithm: (no match)
Unable to negotiate with 192.168.1.26 port 22: no matching host key type found. Their offer: ssh-rsa,ssh-dss

+------------------------------------------------------------------------------------------------------------------------------+

PUBLICK KEY AUTHENTICATION:
AUTENTICAÇÃO SSH COM CHAVE PÚBLICA:

┌──(root㉿ENIAC)-[/home/]
└─# nmap -v -p22 --script=ssh-auth-methods -Pn 192.168.1.26
Host discovery disabled (-Pn). All addresses will be marked 'up' and scan times may be slower.
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-18 21:15 -03
NSE: Loaded 1 scripts for scanning.
NSE: Script Pre-scanning.
Initiating NSE at 21:15
Completed NSE at 21:15, 0.00s elapsed
Initiating ARP Ping Scan at 21:15
Scanning 192.168.1.26 [1 port]
Completed ARP Ping Scan at 21:15, 0.13s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 21:15
Completed Parallel DNS resolution of 1 host. at 21:15, 0.00s elapsed
Initiating SYN Stealth Scan at 21:15
Scanning 192.168.1.26 [1 port]
Discovered open port 22/tcp on 192.168.1.26
Completed SYN Stealth Scan at 21:15, 0.02s elapsed (1 total ports)
NSE: Script scanning 192.168.1.26.
Initiating NSE at 21:15
Completed NSE at 21:15, 0.35s elapsed
Nmap scan report for 192.168.1.26
Host is up (0.00044s latency).

PORT   STATE SERVICE
22/tcp open  ssh
| ssh-auth-methods: 
|   Supported authentication methods: 
|     publickey
|_    password

┌──(root㉿ENIAC)-[/home/]
└─# nmap -v -p22 --script=ssh-brute --script-args='userdb=usuarios.txt,passdb=senhas.txt' -Pn 192.168.1.26


+------------------------------------------------------------------------------------------------

ENUMERANDO NFS-NETWORK FILE SYSTEM PORTA 2049:

┌──(root㉿ENIAC)-[/home/]
└─# nmap --open -sS -p 2049 -Pn 192.168.1.26
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-20 19:15 -03
Nmap scan report for 192.168.1.26
Host is up (0.00048s latency).

PORT     STATE SERVICE
2049/tcp open  nfs

┌──(root㉿ENIAC)-[/home/]
└─# rpcinfo -p 192.168.1.26 | grep nfs
    100003    2   udp   2049  nfs
    100003    3   udp   2049  nfs
    100003    4   udp   2049  nfs
    100003    2   tcp   2049  nfs
    100003    3   tcp   2049  nfs
    100003    4   tcp   2049  nfs

┌──(root㉿ENIAC)-[/home/]
└─# showmount -e 192.168.1.26                    
Export list for 192.168.1.26:
/     *
/home *

┌──(root㉿ENIAC)-[/home/]
└─# mkdir /tmp/nfs

┌──(root㉿ENIAC)-[/home/]
└─# mount -t nfs -o nfsvers=3 192.168.1.26:/ /tmp/nfs
Created symlink /run/systemd/system/remote-fs.target.wants/rpc-statd.service → /usr/lib/systemd/system/rpc-statd.service.

┌──(root㉿ENIAC)-[/home/]
└─# cd /tmp/nfs

┌──(root㉿ENIAC)-[/tmp/nfs]
└─# ls      
bin   cdrom  etc   initrd      lib         media  nohup.out  proc  sbin  sys  usr  vmlinuz
boot  dev    home  initrd.img  lost+found  mnt    opt        root  srv   tmp  var

┌──(root㉿ENIAC)-[~]
└─# umount nfs  

+-----------------------------------------------------------------------------------------------------------------+

ENUMERANDO SNMP PORTA 161 UDP:
SIMPLE NETWORK MANAGEMENT PROTOCOL(Protocolo para gerenciamento de dispositivos em rede)

┌──(root㉿ENIAC)-[/home/]
└─# nmap -sVU -p161 -Pn 192.168.1.26 192.168.1.254

┌──(root㉿ENIAC)-[/home/]
└─# onesixtyone -c wordlists.txt 192.168.1.0/24

┌──(root㉿ENIAC)-[/home/]
└─#snmpwalk -c public -v1 192.168.1.26 (número da consulta)

┌──(root㉿ENIAC)-[/home/]
└─# apt search mibs 
snmp-mibs-downloader/kali-rolling 1.6 all
  install and manage Management Information Base (MIB) files

                                                                                            
┌──(root㉿ENIAC)-[/home/]
└─# apt install snmp-mibs-downloader     
┌──(root㉿ENIAC)-[/home/]
└─# echo " " > /etc/snmp/snmp.conf     
  /etc/snmp/snmp.conf

┌──(root㉿ENIAC)-[/home/]
└─# snmptranslate -IR sysUpTime         
SNMPv2-MIB::sysUpTime

┌──(root㉿ENIAC)-[/home/]
└─# snmpwalk -c public 192.168.1.26 SNMPv2-MIB::sysUpTime 

┌──(root㉿ENIAC)-[/home/hashirama]
└─# snmptranslate -TB icmp
IP-MIB::icmp
IP-MIB::icmpOutAddrMaskReps
IP-MIB::icmpOutAddrMasks
IP-MIB::icmpOutTimestampReps
IP-MIB::icmpOutTimestamps
IP-MIB::icmpOutEchoReps
IP-MIB::icmpOutEchos
IP-MIB::icmpOutRedirects
IP-MIB::icmpOutSrcQuenchs
IP-MIB::icmpOutParmProbs

+---------------------------------------------------------------------------------------------+

ENUMERANDO MYSQL PORTA 3306:

┌──(root㉿ENIAC)-[/home/]
└─# nmap --open -sS -p 3306 -Pn 192.168.1.26      
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-22 21:02 -03
Nmap scan report for 192.168.1.26
Host is up (0.00046s latency).

PORT     STATE SERVICE
3306/tcp open  mysql
┌──(root㉿ENIAC)-[/home/]
└─# nmap --open -sS -p 3306 -Pn 192.168.1.26            
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-05-22 21:06 -03
Nmap done: 1 IP address (1 host up) scanned in 2.27 seconds
                                                                                            
┌──(root㉿ENIAC)-[/home/]
└─# nc 192.168.1.26 3306                         
>
5.0.51a-3ubuntu5v8Qp^ir",OFSOroXH@I,?       